<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login</title>
  <link rel="stylesheet" href="auth.css" />
</head>
<body>

<div class="page">
  <div class="login-card" id="authCard">

    <!-- FORM PANEL -->
    <div class="login-panel">

      <!-- LOGIN FORM -->
      <div class="form login-form">
        <h2>Login</h2>

        <button type="button" class="oauth-btn" onclick="loginWithGoogle()">
          Continue with Google
        </button>

        <button type="button" class="oauth-btn" onclick="loginWithGithub()">
          Continue with GitHub
        </button>

        <div class="divider">OR</div>

        <div class="field">
          <input type="email" placeholder="Email" />
          <span class="icon">üìß</span>
        </div>

        <div class="field">
          <input type="password" placeholder="Password" />
          <span class="icon">üîí</span>
        </div>

        <button type="button" class="login-btn">Login</button>

        <p class="switch">
          Don‚Äôt have an account?
          <span onclick="toggleAuth()">Sign up</span>
        </p>
      </div>

      <!-- SIGNUP FORM -->
      <div class="form signup-form">
        <h2>Create Account</h2>

        <button type="button" class="oauth-btn" onclick="loginWithGoogle()">
          Continue with Google
        </button>

        <button type="button" class="oauth-btn" onclick="loginWithGithub()">
          Continue with GitHub
        </button>

        <div class="divider">OR</div>

        <div class="field">
          <input type="email" placeholder="Email" />
          <span class="icon">üìß</span>
        </div>

        <div class="field">
          <input type="password" placeholder="Password" />
          <span class="icon">üîí</span>
        </div>

        <div class="field">
          <input type="password" placeholder="Confirm Password" />
          <span class="icon">üîí</span>
        </div>

        <button type="button" class="login-btn">Sign Up</button>

        <p class="switch">
          Already have an account?
          <span onclick="toggleAuth()">Sign in</span>
        </p>
      </div>

    </div>

    <!-- GLOW PANEL -->
    <div class="welcome-panel">
      <h1 id="panelText">WELCOME<br>BACK!</h1>
    </div>

  </div>
</div>

<!-- =========================
     SUPABASE AUTH (SINGLE SOURCE)
     ========================= -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<script>
  // ‚úÖ MUST be global (no type="module")
  window.supabaseClient = window.supabase.createClient(
    "https://pjxrjytcurqrmbuhgyoi.supabase.co",
    "PASTE_YOUR_REAL_ANON_KEY_HERE"
  );

  // ‚úÖ expose functions to window (VERY IMPORTANT)
  window.loginWithGoogle = async function () {
    const { error } = await window.supabaseClient.auth.signInWithOAuth({
      provider: "google",
      options: {
        redirectTo: "http://127.0.0.1:5500/frontend/index.html"
      }
    });
    if (error) alert(error.message);
  };

  window.loginWithGithub = async function () {
    const { error } = await window.supabaseClient.auth.signInWithOAuth({
      provider: "github",
      options: {
        redirectTo: "http://127.0.0.1:5500/frontend/index.html"
      }
    });
    if (error) alert(error.message);
  };

  window.toggleAuth = function () {
    const card = document.getElementById("authCard");
    const text = document.getElementById("panelText");

    card.classList.toggle("signup-active");
    text.innerHTML = card.classList.contains("signup-active")
      ? "JOIN<br>US!"
      : "WELCOME<br>BACK!";
  };

  // üîç sanity check
  console.log("loginWithGoogle:", typeof window.loginWithGoogle);
  console.log("toggleAuth:", typeof window.toggleAuth);
</script>

</body>
</html>
